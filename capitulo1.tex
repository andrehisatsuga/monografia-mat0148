\chapter{Meu Primeiro Capítulo}

Um pouco de texto\ldots

\section{Minha Primeira Seção}

\begin{teo}
  \label{teo_principal}
  Existe $n_0$ natural tal que, para todo $n\geq n_0$, a seguinte afirmação é verdadeira: para qualquer coloração das arestas de $K_n$ em vermelho e azul, existe uma partição do conjunto dos vértices de $K_n$ em dois circuitos monocromáticos, um vermelho e outro azul.
\end{teo}

\begin{defi}
	Dado um grafo $G$ e $A, B \subseteq V(G)$ tais que $A\cap B = \emptyset$, dizemos que $(A,B)$ é um par $(\eps,G)$-regular (onde $\eps>0$), ou simplesmente $\eps$-regular, se para todo $X\subseteq A$, $Y\subseteq B$ com $\lvert X\rvert\geq\eps\lvert A\rvert$, $\lvert Y\rvert\geq\eps\lvert B\rvert$, temos
	\[
	\left\lvert \frac{e(X,Y)}{\lvert X\rvert\lvert Y\rvert} - \frac{e(A,B)}{\lvert A\rvert\lvert B\rvert}\right\rvert < \eps\,.
	\]
\end{defi}

\begin{prop}
	\label{prop:remocao_de_grau_pequeno}
	Se $0<\eps<0.2$, e $(A,B)$ é um par $\eps$-regular em um grafo $G$ com $|A| = |B| = m$, então existem $A'\subseteq A$ e $B'\subseteq B$, com $\lvert A'\rvert$, $\lvert B'\rvert\geq(1-\eps)m$, tais que
	\begin{itemize}
		\item $(A', B')$ é $(4\eps)$-regular;
		\item no subgrafo $(A', B')$-bipartido, todo vértice tem grau maior ou igual a $\left(\dfrac{e(A,B)}{m^2} -2\eps\right)m$\,.
	\end{itemize}
	Mais ainda, é possível escolher $A'$ e $B'$ de modo que $|A'| = |B'|$.
\end{prop}

\begin{dem}
	Seja $\delta = \dfrac{e(A,B)}{m^2}$ a densidade do par $(A,B)$ e $X_1 = \{u\in A : \lvert N(u)\cap B\rvert<(\delta - \eps)|B|\}$. Se $|X_1|\geq\eps|A|$, então para $X=X_1$ e $Y=B$ teríamos 
	\[
	\left\lvert \frac{e(X,Y)}{\lvert X\rvert\lvert Y\rvert} - \frac{e(A,B)}{\lvert A\rvert\lvert B\rvert}\right\rvert > \eps\,,
	\]
	absurdo. Logo $|X_1|<\eps|A|$. Analogamente, se definirmos $Y_1 = \{v\in B: |N(v)\cap A|<(\delta-\eps)|A|\}$, então $|Y_1|<\eps|B|$. Suponha, sem perda de generalidade, que $|X_1|\geq|Y_1|$. Então tome $A' = A\setminus X_1$ e $B'\subseteq B\setminus Y_1$ tal que $|A'| = |B'|$. A seguir, verificamos as propriedades de $(A', B')$:
	\vskip 1em
	\textsc{$(A', B')$ é $(4\eps)$-regular:}  
	
	Sejam $X\subseteq A'$ e $Y\subseteq B'$ tais que $|X|\geq 4\eps|A'|$ e $|Y|\geq4\eps |B'|$. Queremos provar que 
	\[
		\left\lvert \frac{e(X,Y)}{\lvert X\rvert\lvert Y\rvert} - \frac{e(A',B')}{\lvert A'\rvert\lvert B'\rvert}\right\rvert < 4\eps\,.
	\]
	Primeiro, como $(A, B)$ é um par $\eps$-regular e $|X|\geq4\eps |A'|\geq \eps |A|$ e $|Y|\geq \eps |B|$, temos que 
	\[
		\left\lvert \frac{e(X,Y)}{\lvert X\rvert\lvert Y\rvert} - \frac{e(A,B)}{\lvert A\rvert\lvert B\rvert}\right\rvert < \eps\,.
	\]
	Basta então provar que 
	\[
		\left| \frac{e(A,B)}{|A||B|} - \frac{e(A',B')}{|A'||B'|}\right| < 3\eps\,.
	\]
	Por um lado, temos que
	\[
		\frac{e(A',B')}{|A'||B'|} > \frac{e(A,B) - 2\eps |A||B|}{|A'||B'|} \geq \frac{e(A,B) - 2\eps |A||B|}{|A||B|} = \frac{e(A,B)}{|A||B|} - 2\eps\,,
	\] 
	o que implica que $\frac{e(A',B')}{|A'||B'|} - \frac{e(A,B)}{|A||B|} > -2\eps$.
	
	Por outro lado, temos que
	\[
		\frac{e(A', B')}{|A'||B'|} < \frac{e(A, B)}{|A'||B'|} \leq \frac{e(A,B)}{(1-\eps)^2|A||B|} < (1+3\eps)\frac{e(A,B)}{|A||B|}\leq \frac{e(A,B)}{|A||B|} + 3\eps\,,
	\]
	donde $\frac{e(A',B')}{|A'||B'|} - \frac{e(A,B)}{|A||B|} < 3\eps$. Logo $\left| \frac{e(A,B)}{|A||B|} - \frac{e(A',B')}{|A'||B'|}\right| < 3\eps$, como queríamos.
	
	\vskip 1em
	
	\textsc{Grau mínimo no subgrafo $(A', B')$-bipartido:} 
	
	Dado $u\in A'$, temos que 
	\[
	|N(u)\cap B'|\geq (\delta-\eps)|B| - \eps|B| = (\delta - 2\eps)|B| = \left( \frac{e(A,B)}{m^2} - 2\eps\right) m\,.
	\]
	Analogamente, para $v\in B'$ temos que $|N(v)\cap A'|\geq \left( \frac{e(A,B)}{m^2} - 2\eps\right) m$. Logo o subgrafo $(A',B')$-bipartido tem grau mínimo maior ou igual a $\left( \frac{e(A,B)}{m^2} - 2\eps\right) m$.
	
\end{dem}

\begin{lema}
	Para todo $\eps>0$ e para todo inteiro positivo $k_0$, existe $K_0 = K_0(\eps,k_0)$ tal que a seguinte afirmação é verdadeira: Para todo grafo $G$, existe uma partição $V(G) = V_0\cup V_1\cup\dots\cup V_k$ tal que 
	\begin{enumerate}
		\item $k_0\leq k\leq K_0$;
		\item $|V_0| < K_0$;
		\item $|V_1| = |V_2| = \dots = |V_k|$;
		\item dentre os $k\choose 2$ pares $(V_i, V_j)$ com $1\leq i<j$, há menos de $\eps {k\choose 2}$ deles que não são $\eps$-regulares.
	\end{enumerate}
\end{lema}

\begin{lema}\label{lema:haxell}
	Seja $0<\eps<1/7$. Seja ainda $G$ um grafo $(V_1, V_2)$-bipartido tal que $|V_1| = |V_2| = m\geq1/\eps$. Suponha que $G$ tem grau mínimo maior ou igual a $7\eps m$, e que para qualquer par de subconjuntos $A\subseteq V_1$ e $B\subseteq V_2$ tal que $|A|,|B|\geq \eps m$, existe uma aresta ligando $A$ a $B$ (isto é, $e(A, B)\geq1$). Então $G$ é hamiltoniano.
\end{lema}

\begin{defi}
	Se $K$ é um grafo $(X,Y)$-bipartido, dizemos que $K$ é \emph{$(b,f)$-expanding} se, para todo $S\subseteq X$ com $|S|\leq b$ vale que $|N(S)|\geq f|S|$, e, simetricamente, para todo $S\subseteq Y$ com $|S|\leq b$, vale $|N(S)|\geq f|S|$.
\end{defi}

\begin{prop}
	Seja $t$ um inteiro positivo. Se $K$ é um grafo bipartido não-vazio e $K$ é $(t,2)$-expanding, então $K$ contém um caminho com $4t$ vértices.
\end{prop}

\begin{dem}
	A ideia é que, dado um caminho em $K$ com $k\leq4t-1$ vértices, conseguimos usar a condição de $K$ ser $(t,2)$-expanding exaustivamente para garantir a existência de um caminho de $k+1$ vértices em $K$. Partindo de uma aresta e aplicando esse fato repetidas vezes, obtemos um caminho de $4t$ vértices.
	
	Primeiro, note que, se temos um caminho $Q = v_1v_2\dots v_k$ em $K$ e uma aresta $v_1v_i\in E(K)$, então $\tilde{Q} = v_{i-1}v_{i-2}\dots v_1v_iv_{i+1}\dots v_{k-1}v_k$ é um caminho em $K$. Mais ainda, quase todos os vértices em $\tilde{Q}$ tem como vizinhos os mesmos que em $Q$, possivelmente em ordem reversa. Diremos que $\tilde{Q}$ é uma \emph{transformação simples} de $Q$ relativa a $v_k$. Se um caminho pode ser obtido de $Q$ a partir de uma sequência de transformações simples relativas a $v_k$, diremos que tal caminho é uma \emph{transformação} de $Q$ (relativa a $v_k$). Note que qualquer transformação de $Q$ mantém $x_k$ como extremidade do caminho. Vamos dizer que um vértice $v$ é um \emph{endpoint} de $Q$ relativo a $v_k$ se existe um caminho $R$ transformação de $Q$ tal que $R$ tem $v$ e $v_k$ como extremidades.
	
	Dado um caminho $P_0 = x_1x_2\dots x_k$ em $K$, com $k\leq 4t-1$, suponha, sem perda de generalidade, que $x_1\in X$, e queremos provar que $K$ contém um caminho de $k+1$ vértices. Seja $U$ o conjunto de endpoints de $P_0$ relativo a $x_k$. Se $N(U)\not\subseteq V(P_0)$, então encontramos um caminho de $k+1$ vértices de $v_k$ a um vizinho de um endpoint de $P_0$. Então, podemos supor que $N(U)\subseteq V(P_0)$. Vejamos que $|U|\geq t$. Com efeito, se $|U|<t$, então $|N(U)|\geq2|U|$. Como o conjunto $\{x_2\}\cup\bigcup_{x_i\in U\setminus\{x_2\}}\{x_{i-1}, x_{i+1}\}$ tem no máximo $2|U|-1$ elementos, existe um vértice $w\in N(U)\setminus(\{x_2\}\cup\bigcup_{x_i\in U\setminus\{x_2\}}\{x_{i-1}, x_{i+1}\})$. Veja que os vizinhos de $w$ em qualquer transformação de $P_0$ são os mesmos que em $P_0$. Além disso, os vizinhos de $w$ não pertencem a $U$. Mas uma aresta que liga $w$ a $U$ dá uma transformação de $P_0$ que tem um vizinho de $w$ como endpoint, absurdo.  Agora, aplique a condição de $(t,2)$-expanding para um subconjunto de $t$ elementos de $U$. Como $|V(P_0)\cap Y| = \lfloor\frac{k}{2}\rfloor\leq 2t-1$, algum vizinho de $U$ não está em $V(P_0)$, e com isso temos um caminho de $k+1$ vértices.
	
\end{dem}

\begin{lema}
	\label{lema:caminho_hamiltoniano}
	Seja $G$ um grafo que contém exatamente:
	\begin{enumerate}
		\item \label{item:regularidade}um grafo $G_0$ bipartido com bipartição $(V',V'')$ tal que cada $v'\in V'$ tem pelo menos $0.15|V''|$ vizinhos em $V''$, cada $v''\in V''$ tem pelo menos $0.15|V'|$ vizinhos em $V'$ e, para quaisquer $W'\subseteq V'$, $W''\subseteq V''$ tais que $|W'|\geq10^{-6}|V'|$, $|W''|\geq10^{-6}|V''|$, existe pelo menos uma aresta entre $W'$ e $W''$;
		\item uma família $\mathcal{P}'$ de $r'$ caminhos vértice-disjuntos, cada um com as duas extremidades em $V'$, tal que nenhum vértice do interior do caminho pertence a $V'\cup V''$;
		\item uma família $\mathcal{P}''$ de $r''$ caminhos vértice-disjuntos, cada um com as duas extremidades em $V''$, tal que nenhum vértice do interior do caminho pertence a $V'\cup V''\cup \bigcup_{P'\in \mathcal{P}'}V(P')$;
	\end{enumerate}
	Sejam $x'$ um vértice de $V'\backslash \bigcup_{P'\in \mathcal{P}'}V(P')$ e $y''$ um vértice de $V''\backslash \bigcup_{P''\in \mathcal{P}''}V(P'')$. Suponha que 
	\[
	r' + r''\leq 0.01m = 0.01\min\{|V'|, |V''|\}
	\]
	e 
	\[
	r'' - r' = |V''| - |V'|\,. 
	\]
	Então existe um caminho em $G$ que começa em $x'$, termina em $y''$, passa por todos os vértices de $V'$ e $V''$ e percorre completamente todos os caminhos de $\mathcal{P}'$ e $\mathcal{P}''$. 
\end{lema}

\begin{dem}
	Dados $x'\in V'\setminus\bigcup_{P'\in \mathcal{P}'}V(P')$ e $y''\in V''\setminus\bigcup_{P''\in \mathcal{P}''}V(P'')$, queremos construir um caminho $P_{x'y''}$ passando por todos os vértices de $V'$ e $V''$ e todas as arestas de caminhos em $\mathcal{P}'$ e $\mathcal{P}''$. Faremos isso em três partes: primeiro, um caminho $P_{x'z''}$ saindo de $x'$ e cobrindo todos os caminhos de $\mathcal{P}'$ e $\mathcal{P}''$; segundo, um caminho $P_{z'y''}$ que termina em $y''$, com uma certa condição para que $P_{z'y''}$ tenha vários ``endpoints'' além de $z'$; e finalmente aplicaremos o Lema \ref{lema:haxell} nos vértices que sobraram para obter um caminho $P_{z''z'}$, de modo que o caminho final $P_{x'y''}$ consiste apenas de juntar $P_{x'z''}$, $P_{z''z'}$ e $P_{z'y''}$.
	
	Para o caminho $P_{x'z''}$, note que, dado um vértice $v'\in V'$ e outro vértice $v''\in V''$, podemos construir um caminho de tamanho três de $v'$ para $v''$ evitando qualquer subconjunto $A'\subset V'\setminus\{v\}$ com $|A'|\leq0.1m$ e qualquer subconjunto $B''\subset V''\setminus\{v''\}$ com $|B''|\leq0.1m$: basta considerar as vizinhanças de $v'$ e $v''$ e aplicar \ref{item:regularidade} para $(N(v')\cap V'')\setminus B''$ e $(N(v'')\cap V')\setminus A'$.
	
	Com isso, basta construir $P_{x'z''}$ de forma gulosa, saindo de $x'$ e percorrendo os caminhos em $\mathcal{P}'$ e $\mathcal{P}''$, gastando caminhos de tamanho três para conectar uma ponta de um caminho de $\mathcal{P}'$ com a ponta de um caminho de $\mathcal{P}''$, e gastando caminhos de tamanho quatro para conectar pontas de dois caminhos em $\mathcal{P}'$ ou dois caminhos de $\mathcal{P}''$ (é só primeiro ir para o outro lado e então usar um caminho de tamanho três). Desse modo, conseguimos obter um caminho $P_{x'z''}$ que começa em $x'$, termina em $z''\in V''$, passa por todas as arestas dos caminhos de $\mathcal{P}'$ e $\mathcal{P}''$, e que satisfaz
	\begin{align*}
	|V(P_{x'z''})\cap V'|\leq 1 + 3(r' + r'')&\leq 0.04m \,,\\
	|V(P_{x'z''})\cap V'|\leq 1 + 3(r' + r'')&\leq 0.04m \,.
	\end{align*}
	
	Para $P_{z'y''}$, comece de $y''$ e percorra um caminho até um $z_0'\in V'$, digamos $P_{z_0'y''}$, de modo que $|V(P_{z_0'y''})| = 2\lfloor0.03m\rfloor - 2$. Daí sejam $P = V'\setminus (V(P_{x'z''})\cup V(P_{z_0'y''}))$ e $Q = V''\cap V(P_{z_0'y''})$.
	
	Como $k\coloneqq |P|\geq |V'| - 0.07m$ e cada vértice de $Q$ manda $0.15m$ arestas para $V'$, então cada vértice de $Q$ manda pelo menos $0.08m$ arestas em $P$, logo
	\[
		e(P,Q)\geq0.08m|Q|\geq0.08m\cdot0.02m = 0.0016m^2\,.
	\]
	
	Seja $\tilde{x} = \#\{v\in P: |N(v)\cap Q|>0.001m\}$. Então 
	\begin{align*}
		0.0016m^2&\leq  e(P,Q)\leq (k-\tilde{x})0.001m + \tilde{x}\cdot 0.03m\Longrightarrow \\
		0.0016m&\leq (k-\tilde{x})0.001 + \tilde{x}\cdot 0.03m\Longleftrightarrow \\
		\Longleftrightarrow 16m&\leq 10(k-\tilde{x}) + 300\tilde{x} = 10k + 290\tilde{x}\Longrightarrow \\
		\Longrightarrow 290\tilde{x}&\geq 16m - 10k\,.
	\end{align*}
	
	Note que $|V'| = |V''| + r' + r''\leq |V''| + 0.01m$, donde $|V'|\leq1.01m$, e daí $k = |P|\leq |V'| - |V(P_{z_0'y''})|\leq1.01m - 0.02m < m$. Logo ficamos com 
	\begin{gather*}
		290\tilde{x}\geq16m - 10k\geq16m - 10m = 6m \\
		\Longrightarrow \tilde{x}\geq \frac{6m}{290} > 0.02m\,.
	\end{gather*}
	Assim, por \ref{item:regularidade}, existe uma aresta entre $\{v\in P: |N(v)\cap Q|>0.001m\}$ e $(N(z_0')\cap V'')\setminus(V(P_{x'z''})\cup V(P_{z_0'y''}))$, logo o caminho $P_{z_0'y''}$ pode ser estendido para um caminho $P_{z'y''}$ tal que $|V(P_{z'y''})| = 2\lfloor0.03m\rfloor$ e $z'$ tem pelo menos $0.001m$ vizinhos em $V(P_{z'y''})\cap V''$. Cada vizinho desses dá um ``endpoint'', isto é, existe $S'\subset V(P_{z'y''})$, $|S'|\geq0.001m$, tal que para todo $s'\in S'$ existe um caminho começando em $y''$ e terminando em $s'$, e que percorre os mesmos vértices de $P_{z'y''}$.
	
	Agora, basta notar que o subgrafo bipartido induzido por $V'\setminus(V(P_{x'z''})\cup V(P_{z'y''}))$ e $V''\setminus(V(P_{x'z''})\cup V(P_{z'y''}))$ é $(10^{-5}, 0.07)$-uniforme, logo pelo Lema \ref{lema:haxell}, existe um circuito hamiltoniano $C$ percorrendo tais vértices.
	
	Para cada vizinho de $z''$ em $C$, existe um caminho $P_{z''t''}$ que percorre exatamente os vértices de $C$ além de $z''$. Em outras palavras, existe um conjunto $T''\subset V''$ tal que $|T''|\geq0.07m$ e para cada $t''\in T''$ existe um caminho $P_{z''t''}$ de $z''$ a $t''$ com $V(P_{z''t''}) = \{z''\}\cup V(C)$.
	
	Por \ref{item:regularidade}, existe pelo menos uma aresta entre $S'$ e $T''$, digamos $\{s', t''\}$. Para tal $s'$, existe um caminho $P_{s'y''}$ de $s'$ a $y''$ que percorre os mesmos vértices de $P_{z'y''}$. Concatenando os caminhos $P_{x'z''}$, $P_{z''t''}$, a aresta $\{t'', s'\}$ e o caminho $P_{s'y''}$, obtemos o caminho desejado.
	
\end{dem}

\begin{lema}
	\label{lema:gyarfas}
	Dada qualquer coloração das arestas do grafo completo $K_n$ em vermelho e azul, existem dois circuitos $C^r$ e $C^b$ em $K_n$, tais que as arestas de $C^r$ são vermelhas, as arestas de $C^b$ são azuis, $V(C^r)\cup V(C^b) = V(K_n)$ e $|V(C^r)\cap V(C^b)|\leq1$.
\end{lema}

\begin{proof}
	Tome um maior caminho $P = u_1\dots u_kv_1\dots v_l$ tal que cada aresta $u_iu_{i+1}$ é azul e $u_kv_1$, $v_1v_2, \dots, v_{l-1}v_l$ são vermelhas. Vamos provar que $P$ é um caminho hamiltoniano. De fato, se $w\notin V(P)$, então considere a aresta $wu_k$. Suponha, sem perda de generalidade, que $wu_k$ é azul. Então o caminho $\tilde{P} = u_1\dots u_k w v_1\dots v_l$ é maior que $P$ e é composto de um caminho azul seguido de um caminho vermelho, absurdo. Logo $P$ é caminho hamiltoniano. 
	
	Suponha, sem perda de generalidade, que $v_lu_1$ é vermelho (se $P = u_1\dots u_k$, troque $v_l$ por $u_k$). Suponha também, sem perda de generalidade, que $u_1u_k$ é azul. Se $l=0$, isto é, $P=u_1\dots u_k$ com $u_1u_k$ azul, então $P$ é um circuito hamiltoniano azul, e temos partição tomando $C^r$ vazio. Se $l=1$, então temos partição de $V(K_n)$ em um circuito azul e um único vértice como circuito vermelho. Suponha então $l\geq2$. Caso $v_1v_l$ seja vermelho, temos partição com $C^b = u_1\dots u_k$ e $C^r = v_1\dots v_l$. Caso $v_1u_1$ seja vermelho, tome $C^b = u_1\dots u_k$ e $C^r = v_1\dots v_lu_1$. Caso $u_kv_l$ seja vermelho, tome $C^b = u_1\dots u_k$ e $C^r = u_kv_1\dots v_l$. Podemos supor, então, que $u_kv_l$, $v_lv_1$ e $v_1u_1$ são azuis. Mas então $Q = u_kv_lv_1u_1\dots u_k$ é um circuito azul. Troque $P$ por $v_1u_1\dots u_kv_l\dots v_2$ e repita o argumento. Como $l$ diminui de dois em dois a cada passo, eventualmente caímos em $l=0$ ou $l=1$, o que encerra a prova.
\end{proof}

\begin{lema}
	\label{lema:bipartido_azul}
	Dada uma coloração das arestas de $K_n$ em vermelho e azul, suponha que exista uma partição dos vértices de $K_n$ em três conjuntos $V_1$, $V_2$ e $V_3$ tal que:
	\begin{enumerate}[(i)]
		\item todas as arestas entre $V_1$ e $V_2$ são azuis;
		\item $\min\{|V_1|, |V_2|\}\geq 5 + 2|V_3|$.
	\end{enumerate}
	Então o conjunto de vértices de $K_n$ pode ser particionado como $V(K_n) = V(C^r)\cup V(C^b)$, onde $C^r$ é um circuito com todas as arestas vermelhas e $C^b$ é um circuito com todas as arestas azuis.
\end{lema}

\begin{proof}
	Primeiramente, vamos construir subconjuntos $V_1'\subseteq V_1$, $V_2'\subseteq V_2$ e $V_3'\subseteq V_3$ de modo que qualquer vértice de $V_3'$ manda apenas arestas vermelhas para $V_1'\cup V_2'$, e de modo que $V_4' \coloneqq V(K_n)\setminus (V_1'\cup V_2'\cup V_3')$ contém um caminho hamiltoniano azul $x_1\dots x_m$ com $x_1\in V_2$ e $x_m\in V_1$. Conseguiremos fazer isso de modo que $\min\{|V_1'|, |V_2'|\}\geq 5 + |V_3'|$.
	
	Começando com $V_1(0) = V_1$, $V_2(0) = V_2$ e $V_3(0) = V_3$, vamos definir recursivamente cadeias descendentes de conjuntos $V_1(k)$, $V_2(k)$ e $V_3(k)$ para $k$ de zero até $l$ tal que $(V_1', V_2', V_3', V_4') = (V_1(l), V_2(l), V_3(l), V(K_n)\setminus (V_1(l)\cup V_2(l)\cup V_3(l)))$ satisfaça as condições do parágrafo anterior.
	
	Suponha construídos $V_1(k)$, $V_2(k)$ e $V_3(k)$ para um $k\geq0$, e que ainda existe pelo menos uma aresta azul entre $V_3(k)$ e $V_1(k)\cup V_2(k)$. Então definimos $V_i(k+1)$ da seguinte forma:
	\begin{enumerate}[\bfseries C\text{a}so 1:]
		\item \label{item:dois_vizinhos_azuis}Se existe $w\in V_3(k)$ tal que $w$ tem pelo menos dois vizinhos azuis $u_1$ e $u_2$ em $V_1(k)$, tome $v\in V_2(k)$ arbitrário e faça $V_1(k+1) = V_1(k)\setminus\{u_1, u_2\}$, $V_2(k+1) = V_2(k)\setminus\{v\}$ e $V_3(k+1) = V_3(k)\setminus\{w\}$.
	\end{enumerate}
	Note que, se $x_{1k}x_{2k}\dots x_{m_kk}$ é um caminho azul com $x_{1k}\in V_2$ e $x_{m_kk}\in V_1$, então $x_{1k}\dots x_{m_kk}vu_1wu_2$ é um caminho azul terminando em $u_2\in V_1$.
	\begin{enumerate}[\bfseries C\text{a}so 2:]
		\item Se existe $w\in V_3(k)$ tal que $w$ tem pelo menos dois vizinhos azuis $v_1$ e $v_2$ em $V_2(k)$, tome, analogamente ao caso anterior, $u\in V_1(k)$ arbitrário e faça $V_1(k+1) = V_1(k)\setminus\{u\}$, $V_2(k+1) = V_2(k)\setminus\{v_1,v_2\}$ e $V_3(k+1) = V_3(k)\setminus\{w\}$.
	\end{enumerate}
	Note que, se $x_{1k}x_{2k}\dots x_{m_kk}$ é um caminho azul com $x_{1k}\in V_2$ e $x_{m_kk}\in V_1$, então $x_{1k}\dots x_{m_kk}v_2wv_1u$ é um caminho azul terminando em $u\in V_1$.
	
	Se nenhum dos dois casos acima se aplica, então todo vértice $w\in V_3(k)$ tem no máximo um vizinho azul em $V_1(k)$ e no máximo um vizinho azul em $V_2(k)$. Nesse último caso, tiramos os vizinhos azuis ao invés do vértice em $V_3(k)$:
	\begin{enumerate}[\bfseries C\text{a}so 3:]
		\item Se existe $w\in V_3(k)$ tal que $w$ tem um único vizinho azul em $V_1(k)$ e/ou um único vizinho azul em $V_2(k)$, tome $u\in V_1(k)$ e $v\in V_2(k)$ de modo que $\{u,v\}$ contém esses possíveis dois vizinhos azuis, e faça $V_1(k+1) = V_1(k)\setminus\{u\}$, $V_2(k+1) = V_2(k+1)\setminus\{v\}$ e $V_3(k+1) = V_3(k)$.
	\end{enumerate}
	Note que, se $x_{1k}x_{2k}\dots x_{m_kk}$ é um caminho azul com $x_{1k}\in V_2$ e $x_{m_kk}\in V_1$, então $x_{1k}\dots x_{m_kk}vu$ é um caminho azul terminando em $u\in V_1$.
	
	Como, a cada passo da construção, o número de vértices em $V_3(k)$ que tem algum vizinho azul em $V_1(k)\cup V_2(k)$ diminui em pelo menos um, o roteiro acima para em $l\leq |V_3|$ passos. Sejam então $V_1' = V_1(l)$, $V_2' = V_2(l)$, $V_3' = V_3(l)$ e $V_4' = V(K_n)\setminus (V_1(l)\cup V_2(l)\cup V_3(l))$, com $V_3'$ e $V_4'$ possivelmente vazios. Como o processo parou, todas as arestas entre $V_3'$ e $V_1'\cup V_2'$ são vermelhas. Como $V_1'\subseteq V_1$ e $V_2'\subseteq V_2$, temos que todas as arestas entre $V_1'$ e $V_2'$ são azuis. Como $|V_1(k+1)| - |V_3(k+1)|\geq |V_1(k)| - |V_3(k)| - 1$, temos que 
	\[
		|V_1'| - |V_3'| \geq |V_1| - |V_3| - l \geq |V_1| - 2|V_3| \geq 5\,,
	\]
	donde $|V_1'|\geq 5 + |V_3'|$ (e, analogamente, $|V_2'|\geq 5 + |V_3'|$). Note, também, que foi construído ao longo do processo um caminho $x_1\dots x_m$ azul passando por todos os vértices de $V_4'$, tal que todas as arestas de $x_1$ a $V_1'$ e todas as arestas de $x_m$ a $V_2'$ são azuis (em particular, $x_1\in V_2$ pois, em todos os casos, o primeiro vértice adicionado ao caminho é um vértice de $V_2$).
	
	Seja $n_i = |V_i'|$ para $i=1,2,3$, e suponha, sem perda de generalidade, que $n_1\geq n_2$. A partir daqui, o argumento se separa de acordo com os casos abaixo. Por exemplo, se $n_1-n_2 = n_3$, então podemos separar $W_1'\subseteq V_1'$ com $|W_i'| = n_1-n_2$ e tomar $C^r$ como sendo um circuito hamiltoniano vermelho no subgrafo bipartido completo entre $V_3'$ e $W_1'$, e $C^b$ como um circuito azul percorrendo primeiro o caminho $x_1\dots x_m$ e alternando entre vértices de $V_2'$ e $V_1'\setminus W_1'$. De forma geral, temos:
	
	\begin{caso}
		$n_1 - n_2\leq n_3$.\\		
		Se $n_3 - n_1 + n_2$ é par, então tome $W_1'\subseteq V_1'$ e $W_2'\subseteq V_2'$ com $|W_1'| = n_1 - n_2 + \frac{n_3 - n_1 + n_2}{2}$ e $|W_2'| = \frac{n_3 - n_1 + n_2}{2}$. Como $|W_1'\cup W_2'| = n_3 = |V_3'|$, existe um circuito vermelho no subgrafo bipartido completo vermelho entre $V_3'$ e $W_1'\cup W_2'$, e um circuito azul cobrindo o restante dos vértices (percorra o caminho $x_1\dots x_m$ primeiro e alterne entre vértices de $V_2'\setminus W_2'$ e $V_1'\setminus W_1'$).
		
		Por outro lado, se $n_3 - n_1 + n_2$ é ímpar, então consideramos o seguinte argumento. Tome uma aresta $e = \{u_1, u_2\}\subseteq V_1'$ qualquer (note que $n_1\geq5>2$, logo $e$ existe). Se $e$ é azul, então fazemos o argumento anterior para $n_1-1$ no lugar de $n_1$ (tomando $W_1'\subseteq V_1'\setminus\{u_1, u_2\}$) e, para o circuito azul, começamos pela aresta $u_1u_2$ e então percorremos o caminho $x_1\dots x_m$ e alternamos entre $V_2'$ e $V_1'$.
		Caso contrário, se $e$ é vermelha, então, para $n_3\geq2$, tome $e\subseteq W_1'\subseteq V_1'$ e $W_2'\subseteq V_2'$ com $|W_1'| = (n_1 + 1) - n_2 + \frac{n_3 - (n_1+1) + n_2}{2}$ e $|W_2'| = \frac{n_3 - n_1 + n_2 + 1}{2}$ (é possível tomar $e\subseteq W_1'$ pois $|W_1'| = \frac{n_1 - n_2 + n_3 + 1}{2}\geq \frac{n_3 + 1}{2}>1$). Note que $|V_1'\setminus W_1'| = |V_2'\setminus W_2'| = \frac{n_1 + n_2 - n_3 - 1}{2}$. Logo existe um circuito azul cobrindo $(V_1'\setminus W_1')\cup(V_2'\setminus W_2')\cup V_4'$. Para construir um circuito vermelho $C^r$ com $V(C^r) = V_3'\cup W_1' \cup W_2'$, basta começar por $u_1u_2$ e alternar entre $V_3'$ e $W_1'\cup W_2'$. Se $n_3 = 1$, então $n_1 = n_2$ e faça $C^r$ como o único vértice em $V_3'$ e $C^b$ começando pelo caminho $x_1\dots x_m$ e alternando entre $V_2'$ e $V_1'$.
	\end{caso} 
	\begin{caso}
		$n_1 - n_2 > n_3$.\\
		Aqui, vamos considerar os tamanhos dos circuitos vermelhos contidos em $V_1'$.
		
		Primeiro, suponha que $V_1'$ contém um circuito vermelho $C_1'$ de tamanho $n_1 - n_2$. Então note que podemos tomar $C^b$ como sendo um circuito com $V(C^b) = (V_1'\setminus V(C_1'))\cup V_2'\cup V_4'$, e $C^r$ como um circuito começando de um vértice de $C_1'$, alternando entre $V(C_1')$ e $V_3'$ até percorrer todos os vértices de $V_3'$, e terminando de percorrer os vértices de $C_1'$ até fechar o circuito.
		
		Agora, suponha que todos os circuitos vermelhos em $V_1'$ têm tamanho menor que $n_1 - n_2$. Pelo Lema \ref{lema:gyarfas} aplicado no grafo completo nos vértices em $V_1'$, existem um circuito vermelho $\tilde{C}^r$ e um caminho azul $P^b$ tal que $V_1' = V(\tilde{C}^r)\cup V(P^b)$ é uma partição. 
	\end{caso}
\end{proof}

\begin{fato}
	\label{fato:caminhos_vermelhos}
	Seja $k$ inteiro positivo, e $n\geq 120k^3$. Considere uma coloração arbitrária das arestas de $K_n$ em vermelho e azul. Suponha que não existe partição de $V(K_n)$ em $V_1$, $V_2$ e $V_3$ satisfazendo as condições do Lema \ref{lema:bipartido_azul}. Então, se $S_1, \dots, S_l$, $T_1, \dots, T_l\subseteq V(K_n)$ são conjuntos disjuntos com $l\geq2$, onde $|S_i|, |T_i|\geq n/2k$ para $i\in \{1, \dots, l\}$, existem caminhos vermelhos $P_1, \dots, P_l$, vértice-disjuntos, cada um de comprimento no máximo $10k$, tal que cada $P_i$ tem um extremo em $S_i$ e outro em $T_i$.
\end{fato}

\begin{dem}
	Vamos provar que os caminhos $P_i$ existem mostrando que podemos escolhê-los um por um, começando por $P_1$, e a cada passo exibindo um $P_j$ que é vértice-disjunto aos anteriores, $P_1, \dots, P_{j-1}$.
	
	Seja então $j\in \{1,\dots, l\}$ e suponha já construídos os caminhos $P_i$, $1\leq i<j$. Seja $R$ o subgrafo de $K_n$ com $V(R) = V(K_n)\setminus W$, onde $W = \bigcup_{i=1}^{j-1} V(P_i)$, dado pelas arestas vermelhas. Para cada $r\in\{0,\dots,5k\}$, defina
	\begin{align*}
		N_r = \{v\in V(K_n)\setminus W: d_R(v, S_j\setminus W) = r\} \,,\\
		N_r' = \{v\in V(K_n)\setminus W: d_R(v, T_j\setminus W) = r\}\,.
	\end{align*}
	Se $(\bigcup_{r=0}^{5k}N_r) \cap (\bigcup_{r=0}^{5k}N_r')\neq \emptyset$, então temos um caminho de tamanho no máximo $10k$ ligando $S_j$ a $T_j$, e tomamos $P_j$ para ser esse caminho. Suponha então que $(\bigcup_{r=0}^{5k}N_r)\cap(\bigcup_{r=0}^{5k}N_r') = \emptyset$. Portanto, $|\bigcup_{r=1}^{5k}N_r|\leq n/2$ ou $|\bigcup_{r=1}^{5k}N_r'|\leq n/2$. Suponha, sem perda de generalidade, que $|\bigcup_{r=1}^{5k}N_r|\leq n/2$. Como os $N_r$ são disjuntos, então existe $r_0$ tal que $|N_{r_0}|\leq n/10k$. Agora, sejam $V_3 = N_{r_0}\cup W$, $V_1 = (S_j\setminus W)\cup \bigcup_{r=1}^{r_0-1}N_r$ e $V_2 = V(K_n)\setminus (V_1\cup V_2)$. Vamos provar que $V_1$, $V_2$ e $V_3$ satisfazem as condições do Lema \ref{lema:bipartido_azul}. Note que o par $(V_1, V_2)$ induz um grafo bipartido azul completo. Vamos verificar agora que $|V_1|\geq 5 + 2|V_3|$. Primeiro, 
	\[
		|V_1| \geq |S_j\setminus W| \geq |S_j| - |W| \geq \frac{n}{2k} - (l-1)(10k+1)\,.
	\] 
	Por outro lado, temos que 
	\[
		5 + 2|V_3| = 5 + 2|N_{r_0}\cup W| \leq 5 + 2\left(\frac{n}{10k} + (l-1)(10k+1)\right)\,.
	\]
	Daí, 
	\begin{gather}
		\frac{n}{2k} - (l-1)(10k+1)\geq 5 + 2\left(\frac{n}{10k} + (l-1)(10k+1)\right) \Longleftrightarrow \nonumber\\
		\frac{n}{2k} - \frac{n}{5k} \geq 5 + 3(l-1)(10k+1)\Longleftrightarrow \nonumber\\
		\frac{3n}{10k} \geq 5 + 3(l-1)(10k+1)\,.  \label{eqn1}
 	\end{gather}
	Como $(l-1)(10k+1)\leq l\cdot10k\leq 10k^2$ e $\frac{3n}{10k}\geq 5 + 3\cdot10k^2 \Leftrightarrow 3n\geq 50k + 300k^3\Leftrightarrow n\geq \frac{50k}{3} + 100k^3$ vale quando $n\geq 120k^3$, temos que $|V_1|\geq 5 + 2|V_3|$. Como $|V_2|\geq |T_j\setminus W|$, temos também que $|V_2|\geq 5 + 2|V_3|$. Logo $V_1, V_2$ e $V_3$ particionam $V(K_n)$ satisfazendo as condições do Lema \ref{lema:bipartido_azul}, contradição.
\end{dem}

\section{Demonstração do Teorema \ref{teo_principal}}

Sejam $\eps = 10^{-60}$ e $k_0 = 2/\eps$. Seja $K_0 = K_0(\eps, k_0)$ a constante garantida pelo Lema da Regularidade de Szemerédi. Iremos provar que o Teorema \ref{teo_principal} é verdade para $n_0 = 120K_0^3$.

Seja $n\geq n_0$ e considere uma coloração arbitrária das arestas de $K_n$ em vermelho e azul. Queremos provar que existe uma partição de $V(K_n)$ em dois circuitos monocromáticos, um vermelho e outro azul.

Seja $R$ o grafo induzido pelas arestas vermelhas e $B$ o induzido pelas arestas azuis. Vamos supor, sem perda de generalidade, que o número de arestas vermelhas é maior ou igual ao número de arestas azuis, ou seja, que pelo menos metade das arestas são vermelhas, i.e., $E(R)\geq \frac{1}{2}\binom{n}{2}$. 
Se a coloração das arestas de $K_n$ satisfaz as hipóteses do Lema \ref{lema:bipartido_azul}, então existe a partição desejada e não há mais nada o que fazer. Logo, podemos supor que isso não ocorre, de modo que podemos usar o Fato \ref{fato:caminhos_vermelhos} para $k\leq K_0$.

Começamos aplicando o Lema da Regularidade de Szemerédi para $G = R$, obtendo uma partição $(\eps, \hat{k}, R)$-regular $\hat{\Pi} = (\hat{V}_0, \hat{V}_1, \dots, \hat{V}_{\hat{k}})$, com $k_0\leq \hat{k}\leq K_0$. Lembre que um par $(\eps, R)$-regular é também $(\eps, B)$-regular; vamos dizer que tais pares são \emph{regulares}. Sobre $\hat{\Pi}$, temos que:
\begin{align*}
	&|\hat{V}_0|<K_0\leq \frac{n}{120K_0^2}<\eps n\,;\\
	&\Big|\Big\{\{i,j\}\in\binom{[\hat{k}]}{2}: (\hat{V}_i, \hat{V}_j) \text{ não é regular}\Big\}\Big| \leq \eps\binom{\hat{k}}{2}\leq \eps\frac{\hat{k}^2}{2}\,.
\end{align*}

%Vamos começar aplicando o Lema da Regularidade de Szemerédi para $G = R$. 

Apesar de $\hat{\Pi}$ ter poucos pares não-regulares, podem haver $\hat{V}_i$'s que são não-regulares com, por exemplo, todos os outros $\hat{V}_j$'s. Vamos tirar esses $\hat{V}_i$'s que são não-regulares com muitos outros $\hat{V}_j$'s da partição e colocá-los em $\hat{V}_0$. Mais especificamente, seja $\bar{V}_0$ o conjunto formado pela união de $\hat{V}_0$ com os $\hat{V}_i$ que são não-regulares com mais de $2\eps^{1/2}(1-\eps^{1/2})\hat{k}$ outros $\hat{V}_j$, e sejam $\bar{V}_1, \dots, \bar{V}_k$ os $\hat{V}_i$ que sobraram. Temos então uma partição $\bar{\Pi} = (\bar{V}_0, \bar{V}_1, \dots, \bar{V}_k)$ com $k\leq \hat{k}$. Como a quantidade de pares não-regulares é menor que $\eps\hat{k}^2/2$, a quantidade de $\hat{V}_i$'s que entraram em $\bar{V}_0$ é no máximo
\[
	\frac{\eps\hat{k}^2}{2\eps^{1/2}(1-\eps^{1/2})\hat{k}} = \frac{\eps^{1/2}\hat{k}}{2(1-\eps^{1/2})} = \eps^{1/2}\hat{k}\,.
\]
Logo $k\geq(1-\eps^{1/2})\hat{k}>\frac{\hat{k}}{2}\geq 1/\eps$, e cada $\bar{V}_i$ é não-regular com no máximo $2\eps^{1/2}(1-\eps^{1/2})\hat{k} < 2\eps^{1/2}k$ outros $\bar{V}_j$. Por fim, $|\bar{V}_0|\leq \eps n + \eps^{1/2}\hat{k}\frac{n}{\hat{k}}<2\eps^{1/2}n$.

Vamos colorir os pares $\{i,j\}$, $1\leq i<j\leq k$ em três cores de acordo com o par $(\bar{V}_i, \bar{V}_j)$. Diremos que $\{i, j\}$ é:
\begin{itemize}
	\item preto, se $(\bar{V}_i, \bar{V}_j)$ é não-regular;
	\item vermelho, se $(\bar{V}_i, \bar{V}_j)$ é regular com $e_R(\bar{V}_i, \bar{V}_j)\geq 0.2|\bar{V}_i||\bar{V}_j|$;
	\item azul, se $(\bar{V}_i, \bar{V}_j)$ é regular com $e_B(\bar{V}_i, \bar{V}_j)>0.8|\bar{V}_i||\bar{V}_j|$.
\end{itemize}

Seja $\Gamma_R$ o grafo reduzido dado pelos pares vermelhos, isto é, $V(\Gamma_R) = \{1,\dots, k\}$ e $E(\Gamma_R) = \{\{i,j\}\in \binom{[k]}{2}: \{i,j\} \text{ é vermelho}\}$. Vamos provar que $e(\Gamma_R)\geq0.185k^2$.
Como estamos supondo $e(R)\geq \frac{1}{2}\binom{n}{2}$, limitaremos por cima a quantidade de arestas em $R$ de acordo com a partição $\bar{\Pi}$. Contando arestas vermelhas, temos então:
\begin{itemize}
	\item[] Dentro de $\bar{V}_1, \dots, \bar{V}_k$: $~\leq k \binom{n/k}{2} < \frac{n^2}{2k} < \frac{\eps}{2}n^2$\,;
	\item[] Dentro de $\bar{V}_0$: $~\leq \binom{|\bar{V}_0|}{2}\leq \binom{2\eps^{1/2}n}{2} < 2\eps n^2$\,;
	\item[] Entre $\bar{V}_0$ e $\bar{V}_1,\dots, \bar{V}_k$: $~\leq |\bar{V}_0||\bar{V}_1\cup\dots\cup \bar{V}_k| \leq 2\eps^{1/2}n\cdot n = 2\eps^{1/2}n^2$\,;
	\item[] Em pares não-regulares: $\leq 2\eps k^2\cdot \left(\frac{n}{k}\right)^2 = 2\eps n^2$\,;
	\item[] Em pares azuis: $\leq \big[\binom{k}{2} - e(\Gamma_R)\big]\cdot 0.2 \cdot \left(\frac{n}{k}\right)^2 < 0.2\frac{n^2}{2} - \frac{e(\Gamma_R)}{5}\left(\frac{n}{k}\right)^2 = \frac{n^2}{10} - \frac{e(\Gamma_R)}{5}\left(\frac{n}{k}\right)^2$\,;
	\item[] Em pares vermelhos: $~\leq e(\Gamma_R)\left(\frac{n}{k}\right)^2$\,.
\end{itemize}
Logo 
\begin{align*}
	&\left(\frac{\eps}{2} + 2\eps + 2\eps^{1/2} + 2\eps\right)n^2 + \frac{n^2}{10} + \frac{4}{5}e(\Gamma_R)\left(\frac{n}{k}\right)^2\geq \frac{1}{2}\binom{n}{2}\\
	&\Longrightarrow  \frac{4}{5}e(\Gamma_R)\left(\frac{n}{k}\right)^2\geq n^2\left(\frac{1}{4} - \frac{1}{10} - 3\eps^{1/2}\right)\,.
\end{align*}
Portanto, $e(\Gamma_R)\geq \frac{5}{4}\big(\frac{1}{4} - \frac{1}{10} - 3\eps^{1/2}\big)k^2 > 0.185k^2$.

Vamos provar que $\Gamma_R$ contém um casamento cobrindo mais de $0.2k$ vértices. Tome um casamento maximal de $\Gamma_R$ e suponha, por absurdo, que tal casamento cobre não mais de $0.2k$ vértices. Então temos pelo menos $\binom{0.8k}{2}> 0.63k^2/2 > \binom{k}{2} - 0.185k^2$ arestas no complementar de $\Gamma_R$, absurdo. Vamos supor, daqui em diante, que $\{\{1,2\}, \dots, \{2s-1, 2s\}\}$ é um casamento \emph{máximo} de $\Gamma_R$, com $s > 0.1k$.

%O próximo passo é definir uma partição de $V(K_n)$

Com o que temos até agora, conseguimos definir uma ``primeira tentativa'' de encontrar os dois circuitos monocromáticos desejados. Mais especificamente, teremos uma partição de $V(K_n)$ em três conjuntos, $\tilde{V}^r$, $\tilde{V}^b$ e $\tilde{V}_0$, de modo que existe um circuito vermelho cobrindo exatamente $\tilde{V}^r$, um circuito azul cobrindo $\tilde{V}^b$ e o conjunto de sobra $\tilde{V}_0$ é pequeno. Mais do que apenas os circuitos, $\tilde{V}^r$ e $\tilde{V}^b$ terão estrutura suficiente de modo a ser possível adicionar vértices de $\tilde{V}_0$ um por um neles mantendo a existência de circuitos monocromáticos que cobrem $\tilde{V}^r$ e $\tilde{V}^b$. Em $\tilde{V}^r$, a estrutura será dada por $s$ pares de conjuntos de vértices satisfazendo as condições do Lema \ref{lema:caminho_hamiltoniano}, e $\tilde{V}^b$ será tal que o subgrafo de $B$ induzido por $\tilde{V}^b$ tem grau mínimo $0.7|\tilde{V}^b|$. Sem mais delongas, vamos às definições precisas.

Para cada $i\in [s]$, como o par $(\bar{V}_{2i-1}, \bar{V}_{2i})$ é regular, temos pela Proposição \ref{prop:remocao_de_grau_pequeno} que existem $V'_{2i-1}\subseteq\bar{V}_{2i-1}$, $V'_{2i}\subseteq\bar{V}_{2i}$ tais que $|V'_{2i-1}| = |V'_{2i}|\geq (1-\eps)|\bar{V}_{2i-1}|$, o par $(V'_{2i-1}, V'_{2i})$ é $(4\eps, R)$-regular, e todo vértice em $V'_{2i-1}$ tem pelo menos $(0.2-2\eps)|\bar{V}_{2i-1}|$ vizinhos vermelhos em $V'_{2i}$, e vice-versa. Pelo Fato \ref{fato:caminhos_vermelhos}, existem caminhos vermelhos $P_1, \dots, P_s$ vértice-disjuntos, cada um de comprimento no máximo $10k$, tal que $P_1$ tem um extremo em $V'_2$ e outro em $V'_3$, $P_2$ tem um extremo em $V'_4$ e outro em $V'_5$, e assim por diante, $P_{s-1}$ tem um extremo em $V'_{2s-2}$ e outro em $V'_{2s-1}$, e $P_s$ tem um extremo em $V'_{2s}$ e outro em $V'_1$. Para fechar um circuito vermelho, vamos usar o Lema \ref{lema:caminho_hamiltoniano} dentro de cada par $(V'_{2i-1}, V'_{2i})$, mas como os caminhos $P_i$ podem ter usado vértices dos $V'_i$, precisamos balancear cada par $(V'_{2i-1}, V'_{2i})$ para aplicar tal lema. Vamos denominar então os vértices de $\bigcup_{i=1}^{s}V(P_i)$ de \emph{inativos}, e vamos nos referir aos vértices que ainda não foram ``inativados'' como os vértices \emph{ativos} (ao longo do argumento, mais vértices serão ``inativados''; os vértices ativos são aqueles que não foram ``inativados'' em nenhum momento anterior). Escolhemos então subconjuntos $V_j\subseteq V'_j$, com $|V_j|\geq |V'_j| - 5k^2$ tais que, para cada $i\in [s]$, os conjuntos $V_{2i-1}$ e $V_{2i}$ tem o mesmo número de vértices ativos. Agora sim, aplicamos o Lema \ref{lema:caminho_hamiltoniano} em cada par $(V_{2i-1}\setminus\bigcup_{i=1}^{2s} V(P_i), V_{2i}\setminus\bigcup_{i=1}^{2s} V(P_i))$, para $r'=r''=0$, garantindo a existência de caminhos ligando extremos dos caminhos $P_1, \dots, P_s$, de modo que todos esses caminhos juntos formam um circuito vermelho que cobre $\tilde{V}^r\coloneqq(\bigcup_{i=1}^{2s}V_i)\cup (\bigcup_{i=1}^{s}V(P_i))$.

Para definir $\tilde{V}^b$, separamos em dois casos. Se $k-2s$ é pequeno, i.e., se os conjuntos $V_{2s+1},\dots, V_k$ que sobraram são poucos, então não temos muita estrutura entre eles (podem ser todos pares pretos no grafo reduzido). Nesse caso, colocamos tudo em $\tilde{V}_0$. Mais precisamente, se $k-2s\leq\eps^{1/3}k$, definimos $\tilde{V}^b = \emptyset$ e $\tilde{V}_0 = V(K_n)\setminus \tilde{V}^r$. Para $k-2s>\eps^{1/3}k$, defina $W = V'_{2s+1}\cup\dots\cup V'_{k}$ e $W'\subseteq W$ como o conjunto dos vértices de $W$ que tem menos de $0.75|W|$ vizinhos azuis em $W$. Como $\{\{1,2\}, \dots, \{2s-1, 2s\}\}$ é casamento máximo de $\Gamma_R$, temos que todos os pares $\{i,j\}$ com $2s+1\leq i < j \leq k$ são pretos ou azuis, e cada $i\in\{2s+1,\dots,k\}$ está em no máximo $2\eps^{1/2}$ pares pretos. Vamos provar que, para todo $i\in\{2s+1,\dots,k\}$, $|\bar{V}_i\cap W'|\leq\eps|\bar{V}_i|$. Suponha, por absurdo, que $|\bar{V}_i\cap W'| > \eps|\bar{V}_i|$. Então, para cada $j\in\{2s+1,\dots,k\}$ tal que $\{i,j\}$ é azul, temos por regularidade que:
\begin{align*}
	\left|\frac{e_B(\bar{V}_i\cap W', \bar{V}_j)}{|\bar{V}_i\cap W'||\bar{V}_j|} - \frac{e_B(\bar{V}_i,\bar{V}_j)}{|\bar{V}_i||\bar{V}_j|}\right| < \eps \quad
	\Longrightarrow \quad \frac{e_B(\bar{V}_i\cap W', \bar{V}_j)}{|\bar{V}_i\cap W'||\bar{V}_j|} > 0.8 - \eps\,.
\end{align*}

Logo $e_B(\bar{V}_i\cap W', \bar{V}_j) > (0.8-\eps)|\bar{V}_i\cap W'||\bar{V}_j| = (0.8-\eps)|\bar{V}_i\cap W'|\frac{|W|}{k-2s}$. Como há pelo menos $k - 2s - 1 - 2\eps^{1/2}k$ pares azuis contendo $i$, temos que 
\begin{align*}
	e(\bar{V}_i\cap W', W\setminus\bar{V}_i) &\geq (k-2s-1-2\eps^{1/2}k)(0.8 - \eps)|\bar{V}_i\cap W'|\frac{|W|}{k-2s} \\
	&> (1 - \frac{3\eps^{1/2}k}{\eps^{1/3}k})(0.8 - \eps)|\bar{V}_i\cap W'||W| \\
	&> 0.75|\bar{V}_i\cap W'||W|.
\end{align*}
Logo algum vértice de $\bar{V}_i\cap W'$ tem mais de $0.75|W|$ vizinhos azuis em $W$, absurdo.

\begin{obs}
  Uma observação.
\end{obs}

\begin{coro}[Nome do corolário]
  Meu primeiro corolário.
\end{coro}

\begin{dem}
  Segue trivialmente do Teorema \ref{teo:nome_sugestivo}.
\end{dem}

\begin{axioma}
  Todo subconjunto de $\mathbb{R}$, que é não vazio e limitado
  superiormente, admite supremo\index{Supremo}.
\end{axioma}

Para mais detalhes veja ~\cite[p. nn]{Lvr} e ~\cite{Art}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: template_monografia
%%% End:
